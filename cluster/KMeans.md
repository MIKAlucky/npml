ä»£ä»·å‡½æ•°ï¼š 

$$J(c,u)=\sum_{i=1}^k||x(i)-u_{c^{(i)}}||^2$$

 $u_{c^{(i)}}$è¡¨ç¤ºç¬¬iä¸ªç±»çš„å‡å€¼ã€‚ æˆ‘ä»¬å¸Œæœ›ä»£ä»·å‡½æ•°æœ€å°ï¼Œç›´è§‚çš„æ¥è¯´ï¼Œå„ç±»å†…çš„æ ·æœ¬è¶Šç›¸ä¼¼ï¼Œå…¶ä¸è¯¥ç±»å‡å€¼é—´çš„è¯¯å·®å¹³æ–¹è¶Šå°ï¼Œå¯¹æ‰€æœ‰ç±»æ‰€å¾—åˆ°çš„è¯¯å·®å¹³æ–¹æ±‚å’Œï¼Œå³å¯éªŒè¯åˆ†ä¸ºkç±»æ—¶ï¼Œå„èšç±»æ˜¯å¦æ˜¯æœ€ä¼˜çš„

# ç®—æ³•æµç¨‹

è¾“å…¥ï¼šå¾…èšç±»çš„æ ·æœ¬Xã€é¢„å…ˆç»™å®šçš„èšç±»æ•°K è¾“å‡ºï¼šæ ·æœ¬Xä¸­æ¯ä¸ªæ ·æœ¬è¢«åˆ†åˆ°çš„ç±»ã€æœ€ç»ˆçš„æ‰€æœ‰èšç±»ä¸­å¿ƒ æµç¨‹ï¼š

1. åˆå§‹åŒ–Kä¸ªèšç±»ä¸­å¿ƒä½œä¸ºæœ€åˆçš„ä¸­å¿ƒ
2. å¾ªç¯æ¯ä¸ªæ ·æœ¬ï¼Œè®¡ç®—å…¶ä¸Kä¸ªèšç±»ä¸­å¿ƒçš„è·ç¦»ï¼Œå°†è¯¥æ ·æœ¬åˆ†åˆ°è·ç¦»æœ€å°çš„é‚£ä¸ªèšç±»ä¸­å¿ƒ
3. å°†æ¯ä¸ªèšç±»ä¸­çš„æ ·æœ¬å‡å€¼ä½œä¸ºæ–°çš„èšç±»ä¸­å¿ƒ
4. é‡å¤æ­¥éª¤2å’Œ3ç›´åˆ°èšç±»ä¸­å¿ƒä¸å†å˜åŒ–

# æ€§èƒ½åˆ†æ

- ä¼˜ç‚¹

  - æ˜¯è§£å†³èšç±»é—®é¢˜çš„ä¸€ç§ç»å…¸ç®—æ³•ï¼Œç®€å•ã€å¿«é€Ÿ
  - å¯¹å¤„ç†å¤§æ•°æ®é›†ï¼Œè¯¥ç®—æ³•æ˜¯ç›¸å¯¹å¯ä¼¸ç¼©å’Œé«˜æ•ˆç‡çš„ã€‚å®ƒçš„å¤æ‚åº¦æ˜¯$O(nkt)$,å…¶ä¸­, $n$æ˜¯æ‰€æœ‰å¯¹è±¡çš„æ•°ç›®, $k$ æ˜¯ç°‡çš„æ•°ç›®, $t$ æ˜¯è¿­ä»£çš„æ¬¡æ•°ã€‚é€šå¸¸$k<<n$ ä¸”$t<<n$
  - å½“ç»“æœç°‡æ˜¯å¯†é›†çš„ï¼Œè€Œç°‡ä¸ç°‡ä¹‹é—´åŒºåˆ«æ˜æ˜¾æ—¶, å®ƒçš„æ•ˆæœè¾ƒå¥½

- ç¼ºç‚¹

  - åœ¨ç°‡çš„å¹³å‡å€¼è¢«å®šä¹‰çš„æƒ…å†µä¸‹æ‰èƒ½ä½¿ç”¨ï¼Œè¿™å¯¹äºå¤„ç†ç¬¦å·å±æ€§çš„æ•°æ®ä¸é€‚ç”¨
  - å¿…é¡»äº‹å…ˆç»™å‡ºK
  - å¯¹åˆå€¼æ•æ„Ÿï¼Œå¯¹äºä¸åŒçš„åˆå§‹å€¼ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸åŒç»“æœ
  - Ã·å¦‚ä½•åˆå§‹åŒ–èšç±»ä¸­å¿ƒ

- éšæœºé€‰æ‹©Kä¸ªæ ·æœ¬ç‚¹

- KMeans++

  1. ä»è¾“å…¥çš„æ•°æ®ç‚¹é›†åˆä¸­éšæœºé€‰æ‹©ä¸€ä¸ªç‚¹ä½œä¸ºç¬¬ä¸€ä¸ªèšç±»ä¸­å¿ƒğœ‡1
  2. å¯¹äºæ•°æ®é›†ä¸­çš„æ¯ä¸€ä¸ªç‚¹ğ‘¥ğ‘–ï¼Œè®¡ç®—å®ƒä¸å·²é€‰æ‹©çš„èšç±»ä¸­å¿ƒä¸­æœ€è¿‘èšç±»ä¸­å¿ƒçš„è·ç¦»$ğ·(ğ‘¥ğ‘–)=ğ‘ğ‘Ÿğ‘”ğ‘šğ‘–ğ‘›||ğ‘¥_ğ‘–âˆ’ğœ‡_ğ‘Ÿ||_2^2$, ğ‘Ÿ=1,2,...ğ‘˜ğ‘ ğ‘’ğ‘™ğ‘’ğ‘ğ‘¡ğ‘’ğ‘‘  <!--_-->
  3. é€‰æ‹©ä¸€ä¸ªæ–°çš„æ•°æ®ç‚¹ä½œä¸ºæ–°çš„èšç±»ä¸­å¿ƒï¼Œé€‰æ‹©çš„åŸåˆ™æ˜¯ï¼šğ·(ğ‘¥)è¾ƒå¤§çš„ç‚¹ï¼Œè¢«é€‰å–ä½œä¸ºèšç±»ä¸­å¿ƒçš„æ¦‚ç‡è¾ƒå¤§
  4. é‡å¤2å’Œ3ç›´åˆ°é€‰æ‹©å‡ºkä¸ªèšç±»è´¨å¿ƒ
  5. åˆ©ç”¨è¿™kä¸ªè´¨å¿ƒæ¥ä½œä¸ºåˆå§‹åŒ–è´¨å¿ƒå»è¿è¡Œæ ‡å‡†çš„K-Meansç®—æ³•

# å¦‚ä½•ç¡®è®¤èšç±»æ•°K

## è‚˜æ–¹æ³•ç¡®å®šæœ€ä½³èšç±»æ•°K

K_meanså‚æ•°çš„æœ€ä¼˜è§£æ˜¯ä»¥æˆæœ¬å‡½æ•°æœ€å°åŒ–ä¸ºç›®æ ‡

æˆæœ¬å‡½æ•°ä¸ºå„ä¸ªç±»ç•¸å˜ç¨‹åº¦ä¹‹å’Œ

æ¯ä¸ªç±»çš„ç•¸å˜ç¨‹åº¦ç­‰äºè¯¥ç±»é‡å¿ƒä¸å…¶å†…éƒ¨æˆå‘˜ä½ç½®è·ç¦»çš„å¹³æ–¹å’Œ

ä½†æ˜¯å¹³å‡ç•¸å˜ç¨‹åº¦ä¼šéšç€Kçš„å¢å¤§å…ˆå‡å°åå¢å¤§ï¼Œæ‰€ä»¥å¯ä»¥æ±‚å‡ºæœ€å°çš„å¹³å‡ç•¸å˜ç¨‹åº¦

```python
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.font_manager import FontProperties
from sklearn.cluster import KMeans
from scipy.spatial.distance import cdist
# 1 æ•°æ®å¯è§†åŒ–
cluster1 = np.random.uniform(0.5, 1.5, (2, 10))
cluster2 = np.random.uniform(3.5, 4.5, (2, 10))
X = np.hstack((cluster1, cluster2)).T
plt.figure()
plt.axis([0, 5, 0, 5])
plt.grid(True)
plt.plot(X[:, 0], X[:, 1], 'k.')
plt.show()
 
# 2 è‚˜éƒ¨æ³•æ±‚æœ€ä½³Kå€¼
K = range(1, 10)
mean_distortions = []
for k in K:
    kmeans = KMeans(n_clusters=k)
    kmeans.fit(X)
    mean_distortions.append(sum(np.min(cdist(X, kmeans.cluster_centers_, metric='euclidean'), axis=1)) / X.shape[0])
plt.plot(K, mean_distortions, 'bx-')
plt.xlabel('k')
# ä»¥ä¸‹ä¸ºè§£å†³ä¸­æ–‡ä¹±ç æ–¹æ³•
font = FontProperties(fname=r'c:\windows\fonts\msyh.ttc', size=20)
plt.ylabel(u'å¹³å‡ç•¸å˜ç¨‹åº¦', fontproperties=font)
plt.title(u'ç”¨è‚˜éƒ¨æ³•ç¡®å®šæœ€ä½³çš„Kå€¼', fontproperties=font)
plt.show()
```

![](images/è‚˜æ–¹æ³•.jpeg)